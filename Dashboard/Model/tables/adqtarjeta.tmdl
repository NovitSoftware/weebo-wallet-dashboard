table adqtarjeta

	column idadqtarjeta
		dataType: int64
		isNullable: false
		formatString: 0
		sourceProviderType: int
		summarizeBy: sum
		sourceColumn: idadqtarjeta

		annotation SummarizationSetBy = Automatic

	column fkcliente
		dataType: int64
		formatString: 0
		sourceProviderType: int
		summarizeBy: sum
		sourceColumn: fkcliente

		annotation SummarizationSetBy = Automatic

	column fkcampania
		dataType: int64
		formatString: 0
		sourceProviderType: int
		summarizeBy: sum
		sourceColumn: fkcampania

		annotation SummarizationSetBy = Automatic

	column fecadq
		dataType: dateTime
		formatString: Long Date
		sourceProviderType: date
		summarizeBy: none
		sourceColumn: fecadq

		variation Variation
			isDefault
			relationship: e175c37f-6fae-41b5-aeeb-1b1a8c442527
			defaultHierarchy: LocalDateTable_a2b7fc0b-240d-441b-9172-72531ad7891d.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column cant
		dataType: int64
		formatString: 0
		sourceProviderType: int
		summarizeBy: sum
		sourceColumn: cant

		annotation SummarizationSetBy = Automatic

	column monto
		dataType: double
		sourceProviderType: float
		summarizeBy: sum
		sourceColumn: monto

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column NuevosSaldos = SUM(adqtarjeta[monto])
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column NuevosSaldosPeriodoAnterior =
			
			CALCULATE(
			    SUM(adqtarjeta[monto]),
			    DATEADD(adqtarjeta[fecadq], -1, YEAR)
			)
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column PromedioSaldoTarjeta
		type: calculated
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation 436ba87b-9c83-4389-a31b-ebd06a36be98 = {"Expression":"\nAVERAGEX(\n    ADDCOLUMNS(\n        VALUES(adqtarjeta[fecadq]),\n        \"FechaAjustada\", adqtarjeta[fecadq] + 1\n    ),\n    CALCULATE(SUM(adqtarjeta[monto]))\n)\n"}

		annotation 277cc1b9-af89-4597-8e15-cacc25c0886b = ```
				A circular dependency was detected: adqtarjeta[Column], adqtarjeta[NuevosSaldosPeriodoAnterior], adqtarjeta[Column].
				
				```

	column VariacionSaldosTarjeta
		type: calculated
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

		annotation 436ba87b-9c83-4389-a31b-ebd06a36be98 = {"Expression":"\nDIVIDE(\n    [NuevosSaldos] - [NuevosSaldosPeriodoAnterior],\n    [NuevosSaldosPeriodoAnterior],\n    0\n)\n"}

		annotation 277cc1b9-af89-4597-8e15-cacc25c0886b = ```
				A circular dependency was detected: adqtarjeta[NuevosSaldosPeriodoAnterior], adqtarjeta[Column], adqtarjeta[NuevosSaldosPeriodoAnterior].
				
				```

	partition adqtarjeta = m
		mode: import
		source =
				let
				    Source = Sql.Databases("40.79.18.177"),
				    Apployalty = Source{[Name="Apployalty"]}[Data],
				    dbo_adqtarjeta = Apployalty{[Schema="dbo",Item="adqtarjeta"]}[Data]
				in
				    dbo_adqtarjeta

